---
title: 开发平台开发手册
sidebarDepth: 2
---

我们通过**开放平台**有序、有限额地在确保用户隐私的前提下开放学生学习平台所使用API接口。加入开放平台，允许你调用我们的数据接口进行自己应用的开发。我们希望为广大大学生，特别是想要上手Web/安卓/IOS/小程序/后端...开发的同学提供一个有趣的实践项目。直接使用我们的API，允许你无需考虑后端实现，无需考虑API搭建成本，可以只会前端就能开发一套自己的应用程序。

如果你：

1. 想要/正在开发一款需要用到在校学生基本信息身份（学号、班级、姓名）的软件
2. 想要/正在开发一款需要集成作业功能、成绩查询、课表功能（尚不支持）的软件
3. 想要/正在开发自己设计的学生学习平台，重新设计界面UI，或者尝试把功能拓展至微信小程序、安卓、IOS
4. ...

那么你就是开放平台的目标用户。你可以申请成为开发者，获取API接口调用权限，并将其用于你的项目中。

## 基本概念

### client

client指一个软件项目。一个用户可以拥有任意多个client。

client Name是该软件项目的名字。

每个client均有一对client ID及client Secret。它们是软件项目调用鉴权接口时“证明你是你”的方法。client ID是可公开的，而client Secret必须严格保密。若client Secret泄露，任何人都可以冒充你的身份调用接口。

调用鉴权接口时常见的sign值算法为：md5(client ID + client Secret + timestamp)。

开发者传递client ID、timestamp和使用client ID、 client Secret 、 timestamp生成的不可逆的字符串序列sign后，开放平台将再次根据开发者传递的信息以及正确的client Secret生成sign，并比对两者是否相同。若相同，则请求合法。

## 鉴权

为保护用户隐私，用户未同意前，不允许开发者直接使用用户账户密码进行登录。

为降低接口调用难度，开发者可以使用永久授权码的方式进行用户授权和登录操作。

### Token(Jwt)

开放平台使用Token进行用户登录状态的传递。使用鉴权接口登录成功后，开放平台将返回Token，开发者需将此Token添加至`Authorization`请求头以进行其他接口的调用。

Token包含用户名、用户ID和请求该Token的client ID。开放平台会解析开发者传递的Token信息，返回相应用户的数据，并记录相应client的接口调用信息。

Token过期时间为1天。过期后需重新获取Token。

### 通过永久授权码访问用户数据

使用永久授权码来进行用户登录鉴权，用户无需把自己的密码暴露给开发者，开发者仍可以非常便捷地访问用户信息。用户授权后，开发者可以直接根据用户名获取对应用户的信息。用户只需在第一次登录开发者应用时输入永久授权码授权即可。

建议微信小程序、安卓、IOS等不方便进行Oauth2的应用使用此方法。

因为用户授权后，第三方应用可以直接使用用户名获取用户信息，**第三方应用应注意不能直接允许用户使用用户名登录，强烈建议使用永久授权码的软件项目实现以下逻辑：**

**微信小程序：**

先获取用户微信唯一ID，再读取用户输入的永久授权码，并进行数据关联绑定。后续用户登录时，直接根据用户微信ID判断用户身份。

**手机APP：**

让用户重新指定密码，用户登录该第三方应用；或使用手机唯一识别码绑定用户身份，后续使用手机唯一识别码判断用户身份。

::: tip “永久”授权码仍可被取消
激活永久授权码后，没有截止期限。但用户随时可以取消授权。
:::

授权流程：

1. 用户尝试登录/开发者尝试读取特定用户信息
2. 若用户未激活永久授权码，则进入3；若用户已激活永久授权码，则进入5
3. 引导用户跳转开放平台获取授权码页面(https://yixicampus.top/authorizationCode)
4. 用户获取授权码，填写至开发者应用
5. 登录成功，返回Token

### 通过Oauth2访问用户数据

![image.png](https://ufilecdn.shadowfish0.top/shadowimagehost/2021/07/13/37132b89063d1.png)

认证步骤如图所示。

在**第一步**跳转时，需提供`client_id`（你的开发者clientID）、`redirect_uri`（第四步从亦习校园跳转回的URL）、`scope`（授权范围）。参考格式如下：

```
https://yixicampus.top/oauth?client_id=yourClientID&redirect_uri=http://your.site&scope=baisc
```

在**第四步**跳转时，若用户许可登录，则亦习校园会跳转回`redirect_uri`指定的地址，并附加GET参数`code`（授权码）。开发者需要将此授权码传到自己的服务器，通过服务器调用[亦习校园授权码认证接口](http://doc.open.yixicampus.top/#/2.x/Oauth%E6%8E%88%E6%9D%83/getTokenUsingPOST)，用授权码换取用户Token。拿到Token后，即可调用亦习校园接口。





